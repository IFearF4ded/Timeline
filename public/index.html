<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Local UDP Flood Controller</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<h1>Local UDP Flood</h1>
<form id="configForm">
  <label>Threads: <input type="number" name="threads" value="4"></label>
  <label>Seconds: <input type="number" name="seconds" value="10"></label>
  <label>Payload (B): <input type="number" name="payload" value="1024"></label>
  <label>Delay (ms): <input type="number" name="delay" value="0"></label>
  <button type="submit">Start</button>
</form>
<button id="stopBtn">Stop</button>
<pre id="log"></pre>
<script>
const logEl = document.getElementById("log");
const form = document.getElementById("configForm");
const stopBtn = document.getElementById("stopBtn");

function appendLog(msg) { logEl.textContent += msg + "\n"; logEl.scrollTop = logEl.scrollHeight; }

form.addEventListener("submit", e => {
  e.preventDefault();
  const data = Object.fromEntries(new FormData(form));
  fetch("/start", { method:"POST", headers:{'Content-Type':'application/json'}, body:JSON.stringify(data) })
    .then(r=>r.json()).then(d=>appendLog("[start] "+JSON.stringify(d)));
});

stopBtn.addEventListener("click", () => {
  fetch("/stop",{method:"POST"}).then(r=>r.json()).then(d=>appendLog("[stop] "+JSON.stringify(d)));
});

// SSE
const evtSource = new EventSource("/events");
evtSource.onmessage = e => appendLog(e.data.replace(/\\n/g,"\n"));
</script>
</body>
</html>
